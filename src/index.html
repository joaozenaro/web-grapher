<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name=" viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Grapher</title>
    <link rel="stylesheet" href="style.css">
    <script type="module" src="main.ts" defer></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>

<body>
    <aside>
        <div x-data="shapesData">
            <ul x-ref="shapelist">
                <template x-for="(shape, index) in $store.shapes" :key="shape.id">
                    <li>
                        <div class="shape-list">
                            <span class="shape-handle">
                                <i class="bi bi-arrows-move"></i>
                            </span>
                            <input type="text" :value="`Shape ${index+1}`" :readonly="!shape.showProperties"
                                :style="!shape.showProperties ? 'outline: none; border: none; cursor: pointer;' : ''" />
                            <button @click="shape.showProperties = !shape.showProperties">
                                <i class="bi bi-sliders2"></i>
                            </button>
                            <button @click="removeShape(shape.id)" class="danger">
                                <i class="bi bi-trash"></i>
                            </button>
                        </div>
                        <template x-if="shape.showProperties">
                            <div class="shape-properties">
                                <div>
                                    <div>
                                        <label :id="'stroke-style-' + shape.id">Border Color</label>
                                        <input type="color" x-model="shape.strokeStyle"
                                            :id="'stroke-style-' + shape.id" />
                                    </div>
                                    <div>
                                        <label :for="'fill-' + shape.id">Border Width</label>
                                        <input type="number" x-model="shape.lineWidth" @keyup="updateShape" />
                                    </div>
                                    <div>
                                        <label :for="'fill-' + shape.id">Fill</label>
                                        <button class="remove-fill danger" @click="shape.fill = ''">
                                            <i class="bi bi-x-square"></i>
                                        </button>
                                        <input type="color" x-model="shape.fill" :id="'fill-' + shape.id" />
                                    </div>
                                    <div>
                                        <label :for="'isClosed-' + shape.id">Closed</label>
                                        <input type="checkbox" x-model="shape.closed" :id="'isClosed-' + shape.id" />
                                    </div>
                                </div>
                                <ul class="vertex-list">
                                    <template x-for="(vertex, vIndex) in shape.vertices" :key="vIndex">
                                        <li>
                                            <input type="number" x-model="vertex.x" placeholder="X"
                                                @keyup="updateShape" />
                                            <input type="number" x-model="vertex.y" placeholder="Y"
                                                @keyup="updateShape" />
                                            <button @click="removeVertex(index, vIndex)">
                                                <i class="bi bi-backspace"></i>
                                            </button>
                                        </li>
                                    </template>
                                </ul>
                                <button @click="addVertex(index)">Add Vertex</button>
                            </div>
                        </template>
                    </li>
                </template>
            </ul>
        </div>
    </aside>
    <main x-data="toolsData">
        <div class="tools">
            <input type="radio" value="Cursor" x-model="tool" />
            <label for="line">(v) Pointer</label>
            <i class="bi bi-cursor"></i>

            <input type="radio" value="Line" x-model="tool" />
            <label for="line">(L)ine</label>
            <i class="bi bi-vector-pen"></i>

            <input type="radio" value="Shape" x-model="tool" />
            <label for="shape">(S)hape</label>
            <i class="bi bi-bounding-box-circles"></i>

            <br />
            <small style="color: gray; margin-left: 10px;">Pressione <code>esc</code> para finalizar a forma.</small>
        </div>

        <span id="mouse-coords">0x0</span>
        <canvas @keyup.escape="endDrawing" @keyup.l="tool = 'Line'" @keyup.v="tool = 'Cursor'" @keyup.s="tool = 'Shape'"
            @click.outside="tool = 'Cursor'" tabindex="1"></canvas>
    </main>
</body>

</html>